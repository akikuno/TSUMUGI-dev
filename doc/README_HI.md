> тЪая╕П рдпрд╣ AI рджреНрд╡рд╛рд░рд╛чФЯцИР рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЕрдиреБрд╡рд╛рдж рд╣реИ; рдпрджрд┐ рдХреЛрдИчЦСхХП рд╣реЛ рддреЛ рдореВрд▓ (README.md) рджреЗрдЦреЗрдВред  
> рдореВрд▓: https://github.com/akikuno/TSUMUGI-dev/blob/main/README.md

<p align="center">
    <a href="https://larc-tsukuba.github.io/tsumugi/" target="_blank">
        <img src="https://raw.githubusercontent.com/akikuno/TSUMUGI-dev/refs/heads/main/image/tsumugi-logo.jpg" alt="Tsumugi Logo" width="80%">
    </a>
</p>

[![License](https://img.shields.io/badge/License-MIT-9cf.svg)](https://choosealicense.com/licenses/mit/)
[![Test](https://img.shields.io/github/actions/workflow/status/akikuno/tsumugi-dev/pytest.yml?branch=main&label=Test&color=brightgreen)](https://github.com/akikuno/tsumugi-dev/actions)
[![PyPI](https://img.shields.io/pypi/v/tsumugi.svg?label=PyPI&color=orange)](https://pypi.org/project/tsumugi/)
[![Bioconda](https://img.shields.io/conda/v/bioconda/tsumugi?label=Bioconda&color=orange)](https://anaconda.org/bioconda/tsumugi)
[![Preprint](https://img.shields.io/badge/bioRxiv-10.64898/2026.02.18.706720-red)](https://doi.org/10.64898/2026.02.18.706720)
[![DOI](https://zenodo.org/badge/441025227.svg)](https://doi.org/10.5281/zenodo.14957711)
[![Contact](https://img.shields.io/badge/Contact-923DE2)](https://forms.gle/ME8EJZZHaRNgKZ979)

**TSUMUGI (Trait-driven Surveillance for Mutation-based Gene module Identification)** [IMPC](https://www.mousephenotype.org/) рдХреЗ KO рдорд╛рдЙрд╕ рдлреЗрдиреЛрдЯрд╛рдЗрдк рдбреЗрдЯрд╛ рд╕реЗ **рдлреЗрдиреЛрдЯрд╛рдЗрдкрд┐рдХ рд╕рдорд╛рдирддрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЬреАрди рдореЙрдбреНрдпреВрд▓ рдирд┐рдХрд╛рд▓рдиреЗ рдФрд░ рджреГрд╢реНрдп рдмрдирд╛рдиреЗ** рдХрд╛ рд╡реЗрдм рдЯреВрд▓ рд╣реИред  
рдпрд╣ рд╡реЗрдм рдкрд░ рд╕рднреА рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рд╣реИЁЯСЗя╕П  
ЁЯФЧhttps://larc-tsukuba.github.io/tsumugi/

**TSUMUGI(ч┤буБО)** рдХрд╛ рдЕрд░реНрде рд╣реИ тАЬрдлреЗрдиреЛрдЯрд╛рдЗрдк рдмрдирд╛рдиреЗ рд╡рд╛рд▓реЗ рдЬреАрди рд╕рдореВрд╣ рдХреЛ рдзрд╛рдЧреЗ рдХреА рддрд░рд╣ рдмреБрдирдирд╛тАЭред

# ЁЯУЦ TSUMUGI рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

TSUMUGI рддреАрди рддрд░рд╣ рдХреЗ рдЗрдирдкреБрдЯ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

### рдлреЗрдиреЛрдЯрд╛рдЗрдк (Phenotype)
рд░реБрдЪрд┐ рдХрд╛ рдлреЗрдиреЛрдЯрд╛рдЗрдк рджрд░реНрдЬ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЙрд╕ рдлреЗрдиреЛрдЯрд╛рдЗрдк рдХреЛ рджрд┐рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ KO рдорд╛рдЙрд╕ рдореЗрдВ **рдХреБрд▓ рдорд┐рд▓рд╛рдХрд░ рд╕рдорд╛рди рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╡рд╛рд▓реЗ рдЬреАрди рд╕рдореВрд╣** рдорд┐рд▓реЗрдВред  
рдлреЗрдиреЛрдЯрд╛рдЗрдк рдирд╛рдо [MPO](https://www.informatics.jax.org/vocab/mp_ontology) рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВред  
ЁЯСЙ [рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕реВрдЪреА](https://github.com/larc-tsukuba/tsumugi/blob/main/data/available_mp_terms.txt)

### рдЬреАрди (Gene)
рдПрдХ рдЬреАрди рджреЗрдВ рдФрд░ **рд╕рдорд╛рди KO рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╡рд╛рд▓реЗ рдЕрдиреНрдп рдЬреАрди рд╕рдореВрд╣** рдЦреЛрдЬреЗрдВред  
рдЬреАрди рдкреНрд░рддреАрдХ [MGI](http://www.informatics.jax.org/) рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИрдВред  
ЁЯСЙ [рдЬреАрди рд╕реВрдЪреА](https://github.com/larc-tsukuba/tsumugi/blob/main/data/available_gene_symbols.txt)

### рдЬреАрди рд╕реВрдЪреА (Gene List)
рдПрдХрд╛рдзрд┐рдХ рдЬреАрди (рдкреНрд░рддрд┐ рдкрдВрдХреНрддрд┐ рдПрдХ) рджреЗрдВ рдФрд░ **рд╕реВрдЪреА рдХреЗ рднреАрддрд░** рд╕рдорд╛рди рдлреЗрдиреЛрдЯрд╛рдЗрдк рдЦреЛрдЬреЗрдВред  
> [!CAUTION]  
> рдпрджрд┐ рдХреЛрдИ рд╕рдорд╛рди рдЬреАрди рдирд╣реАрдВ рдорд┐рд▓рд╛: `No similar phenotypes were found among the entered genes.`  
> рдпрджрд┐ 200 рд╕реЗ рдЕрдзрд┐рдХ рдорд┐рд▓реЗ: `Too many genes submitted. Please limit the number to 200 or fewer.`

### ЁЯУе рдХрдЪреНрдЪрд╛ рдбреЗрдЯрд╛ рдбрд╛рдЙрдирд▓реЛрдб
TSUMUGI gzip-рдХрдВрдкреНрд░реЗрд╕реНрдб JSONL рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

#### `genewise_phenotype_annotations.jsonl.gz`
- рдЬреАрди рдкреНрд░рддреАрдХ (рдЬреИрд╕реЗ "1110059G10Rik")  
- Marker accession ID (рдЬреИрд╕реЗ "MGI:1913452")  
- рдлреЗрдиреЛрдЯрд╛рдЗрдк рдирд╛рдо/ID (рдЬреИрд╕реЗ "fused joints", "MP:0000137")  
- Effect size (рдЬреИрд╕реЗ 0.0, 1.324)  
- Significance (True/false)  
- Zygosity ("Homo", "Hetero", "Hemi")  
- Life stage ("Embryo", "Early", "Interval", "Late")  
- Sexual dimorphism ("", "Male", "Female")  
- Disease annotation (рдЬреИрд╕реЗ [] рдпрд╛ "Premature Ovarian Failure 18")

рдЙрджрд╛рд╣рд░рдг:
```
{"significant": true, "sexual_dimorphism": "Female", "effect_size": 0.0119677350763567, "marker_symbol": "4930447C04Rik", "zygosity": "Homo", "marker_accession_id": "MGI:1923051", "mp_term_id": "MP:0000063", "disease_annotation": ["Male Infertility With Azoospermia Or Oligozoospermia Due To Single Gene Mutation", "Premature Ovarian Failure 18", "Spermatogenic Failure 52"], "life_stage": "Early", "mp_term_name": "decreased bone mineral density"}
```

#### `pairwise_similarity_annotations.jsonl.gz`
- рдЬреАрди рдпреБрдЧреНрдо (`gene1_symbol`, `gene2_symbol`)  
- `phenotype_shared_annotations` (рдЬреАрд╡рди рдЪрд░рдг, zygosity, рдпреМрди рджреНрд╡рд┐рд░реВрдкрддрд╛ рдЬреИрд╕реЗ рдореЗрдЯрд╛рдбреЗрдЯрд╛)  
- `phenotype_similarity_score` (Resnik-рдЖрдзрд╛рд░рд┐рдд Phenodigm рд╕реНрдХреЛрд░, 0тАУ100)

рдЙрджрд╛рд╣рд░рдг:
```
{"gene1_symbol": "1500009L16Rik", "gene2_symbol": "Aak1", "phenotype_shared_annotations": [{"mp_term_name": "increased circulating enzyme level", "life_stage": "Early", "zygosity": "Homo", "sexual_dimorphism": "None"}], "phenotype_similarity_score": 47}
```

# ЁЯМР рдиреЗрдЯрд╡рд░реНрдХ

рдЗрдирдкреБрдЯ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкреЗрдЬ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛрдХрд░ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрд╡рддрдГ рдмрдирддрд╛ рд╣реИред

> [!IMPORTANT]  
> **3 рдпрд╛ рдЕрдзрд┐рдХ рд╕рд╛рдЭрд╛ рдЕрд╕рд╛рдорд╛рдиреНрдп рдлреЗрдиреЛрдЯрд╛рдЗрдк** рддрдерд╛ **рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕рдорд╛рдирддрд╛ > 0.0** рд╡рд╛рд▓реЗ рдЬреАрди рдпреБрдЧреНрдо рджреГрд╢реНрдп рдореЗрдВ рджрд┐рдЦрддреЗ рд╣реИрдВред

### рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдирд▓
**рдиреЛрдб** рдЬреАрди рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВред рдХреНрд▓рд┐рдХ рдкрд░ KO рдорд╛рдЙрд╕ рдореЗрдВ рджреЗрдЦреЗ рдЧрдП рдЕрд╕рд╛рдорд╛рдиреНрдп рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕реВрдЪреА рджрд┐рдЦрддреА рд╣реИ; рдбреНрд░реИрдЧ рд╕реЗ рд╕реНрдерд╛рди рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВред  
**рдПрдЬ** рдХреНрд▓рд┐рдХ рдкрд░ рд╕рд╛рдЭрд╛ рдлреЗрдиреЛрдЯрд╛рдЗрдк рдХрд╛ рд╡рд┐рд╡рд░рдг рджрд┐рдЦрддрд╛ рд╣реИред
**Modules** outline gene subnetworks. Click a module to list phenotypes of its genes; drag modules to reposition and avoid overlap.

### рдХрдВрдЯреНрд░реЛрд▓ рдкреИрдирд▓
рдмрд╛рдПрдБ рдкреИрдирд▓ рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВред

#### рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕рдорд╛рдирддрд╛ рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░
`Phenotypes similarity` рд╕реНрд▓рд╛рдЗрдбрд░ ResnikтЖТPhenodigm рд╕реНрдХреЛрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ edges рдХрд╛ threshold рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИуАВ  
> рдЧрдгрдирд╛ рд╡рд┐рдзрд┐: ЁЯСЙ [ЁЯФН рд╕рдорд╛рди рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╡рд╛рд▓реЗ рдЬреАрди рд╕рдореВрд╣ рдХреА рдЧрдгрдирд╛](#-рд╕рдорд╛рди-рдлреЗрдиреЛрдЯрд╛рдЗрдк-рд╡рд╛рд▓реЗ-рдЬреАрди-рд╕рдореВрд╣-рдХреА-рдЧрдгрдирд╛)

#### рдлреЗрдиреЛрдЯрд╛рдЗрдк рдЧрдВрднреАрд░рддрд╛ рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░
`Phenotype severity` рд╕реНрд▓рд╛рдЗрдбрд░ KO рдорд╛рдЙрд╕ рдореЗрдВ рдкреНрд░рднрд╛рд╡ рдЖрдХрд╛рд░ (severity) рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдиреЛрдбреНрд╕ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рддрд╛ рд╣реИуАВ рдорд╛рди рдЬрд┐рддрдирд╛ рдмрдбрд╝рд╛ рд╣реЛрдЧрд╛, рдкреНрд░рднрд╛рд╡ рдЙрддрдирд╛ рдЕрдзрд┐рдХ рд╣реЛрдЧрд╛уАВ  
> рджреНрд╡рд┐рдЖрдзрд╛рд░реА рдлреЗрдиреЛрдЯрд╛рдЗрдк (рдЙрджрд╛рд╣рд░рдг: [abnormal embryo development](https://larc-tsukuba.github.io/tsumugi/app/phenotype/abnormal_embryo_development.html); рджреНрд╡рд┐рдЖрдзрд╛рд░реА рд╕реВрдЪреА: [рдпрд╣рд╛рдБ](https://github.com/larc-tsukuba/tsumugi/blob/main/data/binary_phenotypes.txt)) рдпрд╛ рдПрдХрд▓ рдЬреАрди рдЗрдирдкреБрдЯ рдкрд░ рдпрд╣ рдЫрд┐рдкрд╛ рд░рд╣рддрд╛ рд╣реИуАВ

#### Genotype рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ
- `Homo`(рд╕рдордпреБрдЧреНрдордЬреА)
- `Hetero`(рд╡рд┐рд╖рдордпреБрдЧреНрдордЬреА)
- `Hemi`(рдЕрд░реНрдзрдпреБрдЧреНрдордЬреА)

#### рд▓рд┐рдВрдЧ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ
- `Female`
- `Male`

#### рдЬреАрд╡рди рдЪрд░рдг рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ
- `Embryo`
- `Early`(0тАУ16 рд╕рдкреНрддрд╛рд╣)
- `Interval`(17тАУ48 рд╕рдкреНрддрд╛рд╣)
- `Late`(49 рд╕рдкреНрддрд╛рд╣ рд╕реЗ рдЕрдзрд┐рдХ)

### рдорд╛рд░реНрдХрдЕрдк рдкреИрдирд▓
#### Highlight: Human Disease
IMPC Disease Models Portal рдбреЗрдЯрд╛ рд╕реЗ рд░реЛрдЧ-рд╕рдВрдмрдВрдзрд┐рдд рдЬреАрди рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд░рддрд╛ рд╣реИуАВ

#### Search: Specific Gene
рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдЬреАрди рдирд╛рдо рдЦреЛрдЬреЗрдВуАВ

#### Layout & Display
рд▓реЗрдЖрдЙрдЯ, рдлрд╝реЙрдиреНрдЯ рдЖрдХрд╛рд░, рдПрдЬ рдХреА рдореЛрдЯрд╛рдИ, рдФрд░ рдиреЛрдб рдкреНрд░рддрд┐рдХрд░реНрд╖рдг (Cose рд▓реЗрдЖрдЙрдЯ) рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВуАВ

#### Export
PNG/CSV/GraphML рдореЗрдВ рдирд┐рд░реНрдпрд╛рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВуАВ  
CSV рдореЗрдВ рдореЙрдбреНрдпреВрд▓ ID рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдЬреАрди рдХреА рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕реВрдЪреА рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИ, рдФрд░ GraphML Cytoscape рд╕рдВрдЧрдд рд╣реИуАВ

# ЁЯЫа рдХрдорд╛рдВрдб-рд▓рд╛рдЗрди рдЗрдВрдЯрд░рдлрд╝реЗрд╕

TSUMUGI CLI рдЖрдкрдХреЛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЧрдП рдирд╡реАрдирддрдо IMPC рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рджреЗрддрд╛ рд╣реИ рдФрд░ рд╡реЗрдм рдЯреВрд▓ рд╕реЗ рдЕрдзрд┐рдХ рд╕реВрдХреНрд╖реНрдо рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ/рдЖрдЙрдЯрдкреБрдЯ рд╡рд┐рдХрд▓реНрдк рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

## рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

- IMPC `statistical-results-ALL.csv.gz` рд╕реЗ рдкреБрдирдГ рдЧрдгрдирд╛ (рд╡реИрдХрд▓реНрдкрд┐рдХ `mp.obo`, `impc_phenodigm.csv`).  
- MP рд╢рдмреНрджреЛрдВ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐/рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдкрд░ рдлрд╝рд┐рд▓реНрдЯрд░ред  
- рдЬреАрди рд╕реВрдЪреА рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░ (рдХреЙрдорд╛-рд╕реЗрдкрд░реЗрдЯреЗрдб рдпрд╛ рдЯреЗрдХреНрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓)ред  
- рдЖрдЙрдЯрдкреБрдЯ: GraphML (`tsumugi build-graphml`), рдСрдлрд╝рд▓рд╛рдЗрди webapp рдмрдВрдбрд▓ (`tsumugi build-webapp`).

## рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди

BioConda:
```bash
conda install -c conda-forge -c bioconda tsumugi
```

PyPI:
```bash
pip install tsumugi
```

`tsumugi --version` рд╕реЗ рд╡рд░реНрдЬрд╝рди рджрд┐рдЦреЗ рддреЛ рдЖрдк рддреИрдпрд╛рд░ рд╣реИрдВред

## рдЙрдкрд▓рдмреНрдз рдХрдорд╛рдВрдб

- `tsumugi run`: IMPC рдбреЗрдЯрд╛ рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдкреБрдирдГ рдЧрдгрдирд╛  
- `tsumugi mp --include/--exclude (--pairwise/--genewise)`: MP рд╢рдмреНрджреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓/рдмрд╣рд┐рд╖реНрдХреГрдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ gene pairs рдпрд╛ genes рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░реЗрдВ  
- `tsumugi count --pairwise/--genewise (--min/--max)`: phenotype рдЧрд┐рдирддреА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдлрд╝рд┐рд▓реНрдЯрд░ (pairs/genes)  
- `tsumugi score (--min/--max)`: phenotype similarity score рдкрд░ рдлрд╝рд┐рд▓реНрдЯрд░ (pairs)  
- `tsumugi genes --keep/--drop`: gene list рд╕реЗ keep/drop (рдХреЙрдорд╛ рдпрд╛ рдЯреЗрдХреНрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓)  
- `tsumugi life-stage --keep/--drop`: life stage рдлрд╝рд┐рд▓реНрдЯрд░ (Embryo/Early/Interval/Late)  
- `tsumugi sex --keep/--drop`: sex рдлрд╝рд┐рд▓реНрдЯрд░ (Male/Female/None)  
- `tsumugi zygosity --keep/--drop`: zygosity рдлрд╝рд┐рд▓реНрдЯрд░ (Homo/Hetero/Hemi)  
- `tsumugi build-graphml`: GraphML рдмрдирд╛рдПрдБ (Cytoscape рдЖрджрд┐)  
- `tsumugi build-webapp`: TSUMUGI webapp assets рдмрдирд╛рдПрдВ (рд╕реНрдерд╛рдиреАрдп HTML/CSS/JS)

> [!NOTE]
> рд╕рднреА рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рд╕рдмрдХрдорд╛рдВрдб JSONL рдХреЛ STDOUT рдкрд░ рд╕реНрдЯреНрд░реАрдо рдХрд░рддреЗ рд╣реИрдВред  
> рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕реЗрд╡ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `>` рд╕реЗ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░реЗрдВред

> [!IMPORTANT]
> `tsumugi run` рдХреЛ рдЫреЛрдбрд╝рдХрд░ рд╕рднреА рдХрдорд╛рдВрдб рдХреЛ `pairwise_similarity_annotation.jsonl.gz` рдпрд╛ `genewise_phenotype_annotation.jsonl.gz` рдЪрд╛рд╣рд┐рдПред
> рджреЛрдиреЛрдВ рдлрд╛рдЗрд▓реЗрдВ [TSUMUGI рд╢реАрд░реНрд╖ рдкреГрд╖реНрда](https://larc-tsukuba.github.io/tsumugi/) рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

## рдЙрдкрдпреЛрдЧ

### IMPC рдбреЗрдЯрд╛ рд╕реЗ рдкреБрдирдГ рдЧрдгрдирд╛ (`tsumugi run`)
рдЕрдЧрд░ `--mp_obo` рдЫреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╣реИ, TSUMUGI bundled `data-version: releases/2025-08-27/mp.obo` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  
рдЕрдЧрд░ `--impc_phenodigm` рдЫреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╣реИ, рдпрд╣ 2025-10-01 рдХреЛ [IMPC Disease Models Portal](https://diseasemodels.research.its.qmul.ac.uk/) рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
```bash
tsumugi run   --output_dir ./tsumugi-output   --statistical_results ./statistical-results-ALL.csv.gz   --threads 8
```
рдЖрдЙрдЯрдкреБрдЯ: `./tsumugi-output` рдореЗрдВ genewise annotations (genewise_phenotype_annotations.jsonl.gz), pairwise similarity data (pairwise_similarity_annotations.jsonl.gz) рдФрд░ visualization assets (`TSUMUGI-webapp`) рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

> [!IMPORTANT]  
> `TSUMUGI-webapp` рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ OS-рд╡рд┐рд╢рд┐рд╖реНрдЯ launch scripts рд╢рд╛рдорд┐рд▓ рд╣реИрдВ; рдбрдмрд▓-рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рд▓реЛрдХрд▓ webapp рдЦреЛрд▓реЗрдВ:  
> - Windows: `open_webapp_windows.bat`  
> - macOS: `open_webapp_mac.command`  
> - Linux: `open_webapp_linux.sh`

### MP term рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░ (`tsumugi mp --include/--exclude`)
рд░реБрдЪрд┐ рдХреЗ phenotypes рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ gene pairs (рдпрд╛ genes) рдирд┐рдХрд╛рд▓реЗрдВ, рдпрд╛ рдРрд╕реЗ pairs рдЬрд┐рдирдореЗрдВ рд╡реЗ phenotypes рдорд╛рдкреЗ рдЧрдП рд▓реЗрдХрд┐рди significant abnormality рдирд╣реАрдВ рдорд┐рд▓реАред

```bash
tsumugi mp [-h] (-i MP_ID | -e MP_ID) [-g | -p] [-m PATH_MP_OBO] [-a PATH_GENEWISE_ANNOTATIONS] [--in PATH_PAIRWISE_ANNOTATIONS]
                  [--life_stage LIFE_STAGE] [--sex SEX] [--zygosity ZYGOSITY]
```

#### `-i MP_ID`, `--include MP_ID`
рдирд┐рд░реНрджрд┐рд╖реНрдЯ MP term рд╡рд╛рд▓реЗ genes/gene pairs рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ (descendants рд╕рд╣рд┐рдд)ред

#### `-e MP_ID`, `--exclude MP_ID`
рдирд┐рд░реНрджрд┐рд╖реНрдЯ MP term (descendants рд╕рд╣рд┐рдд) рдХреЗ рд▓рд┐рдП рдорд╛рдкреЗ рдЧрдП genes/gene pairs рд▓реМрдЯрд╛рдПрдБ рдЬрд┐рдирдореЗрдВ significant phenotype рдирд╣реАрдВ рджрд┐рдЦрд╛ред `-a/--genewise_annotations` рдЖрд╡рд╢реНрдпрдХ рд╣реИред

#### `-g`, `--genewise`
gene рд╕реНрддрд░ рдкрд░ рдлрд╝рд┐рд▓реНрдЯрд░ред `genewise_phenotype_annotations.jsonl(.gz)` рдкрдврд╝рддрд╛ рд╣реИред `--genewise` рдХреЗ рд╕рд╛рде `-a/--genewise_annotations` рджреЗрдВред

#### `-p`, `--pairwise`
pair рд╕реНрддрд░ рдкрд░ рдлрд╝рд┐рд▓реНрдЯрд░ред рд▓рдХреНрд╖реНрдп `pairwise_similarity_annotations.jsonl(.gz)` рд╣реИред `--in` рди рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

#### `-m PATH_MP_OBO`, `--mp_obo PATH_MP_OBO`
Mammalian Phenotype ontology (mp.obo) рдХрд╛ рдкрд╛рдеред рдЫреЛрдбрд╝рдиреЗ рдкрд░ bundled `data/mp.obo` рдЗрд╕реНрддреЗрдорд╛рд▓ рд╣реЛрддрд╛ рд╣реИред

#### `-a PATH_GENEWISE_ANNOTATIONS`, `--genewise_annotations PATH_GENEWISE_ANNOTATIONS`
genewise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред `--exclude` рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ; `--genewise` рдореЗрдВ рднреА рджреЗрдВред

#### `--in PATH_PAIRWISE_ANNOTATIONS`
pairwise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред рди рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

#### `--life_stage LIFE_STAGE`
life stage рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдлрд╝рд┐рд▓реНрдЯрд░ред рдорд╛рди: `Embryo`, `Early`, `Interval`, `Late`ред

#### `--sex SEX`
sexual dimorphism рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдлрд╝рд┐рд▓реНрдЯрд░ред annotations рдореЗрдВ рдореМрдЬреВрдж рдорд╛рди (рдЬреИрд╕реЗ `Male`, `Female`, `None`) рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

#### `--zygosity ZYGOSITY`
zygosity рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдлрд╝рд┐рд▓реНрдЯрд░ред рдорд╛рди: `Homo`, `Hetero`, `Hemi`ред

```bash
# MP:0001146 (abnormal testis morphology) рдпрд╛ рдЙрд╕рдХреЗ descendants (рдЬреИрд╕реЗ MP:0004849 abnormal testis size) рд╡рд╛рд▓реЗ gene pairs рдирд┐рдХрд╛рд▓реЗрдВ
tsumugi mp --include MP:0001146   --in pairwise_similarity_annotations.jsonl.gz   > pairwise_filtered.jsonl

# MP:0001146 рдФрд░ descendants рдорд╛рдкреЗ рдЧрдП рдереЗ рд▓реЗрдХрд┐рди significant abnormality рдирд╣реАрдВ рджрд┐рдЦреА
tsumugi mp --exclude MP:0001146   --genewise genewise_phenotype_annotations.jsonl.gz   --in pairwise_similarity_annotations.jsonl.gz   > pairwise_filtered.jsonl

# gene рд╕реНрддрд░ рдкрд░ MP:0001146 рд╡рд╛рд▓реЗ significant phenotypes рдирд┐рдХрд╛рд▓реЗрдВ
tsumugi mp --include MP:0001146   --genewise   --genewise_annotations genewise_phenotype_annotations.jsonl.gz   > genewise_filtered.jsonl

# gene рд╕реНрддрд░ рдкрд░ MP:0001146 (descendants рд╕рд╣рд┐рдд) рдорд╛рдкрд╛ рдЧрдпрд╛ рд▓реЗрдХрд┐рди significant рдирд╣реАрдВ рдерд╛
tsumugi mp --exclude MP:0001146   --genewise   --genewise_annotations genewise_phenotype_annotations.jsonl.gz   > genewise_no_phenotype.jsonl
```

> [!IMPORTANT]
> **рдирд┐рд░реНрджрд┐рд╖реНрдЯ MP ID рдХреЗ descendant terms рднреА рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред**  
> рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `MP:0001146 (abnormal testis morphology)` рджреЗрдиреЗ рдкрд░ `MP:0004849 (abnormal testis size)` рдЬреИрд╕реЗ descendants рднреА рд╢рд╛рдорд┐рд▓ рд╣реЛрдВрдЧреЗред

### phenotype counts рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░ (`tsumugi count`)
```bash
tsumugi count [-h] (-g | -p) [--min MIN] [--max MAX] [--in PATH_PAIRWISE_ANNOTATIONS] [-a PATH_GENEWISE_ANNOTATIONS]
```

genes рдпрд╛ gene pairs рдХреЛ phenotype рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рддрд╛ рд╣реИред рдХрдо рд╕реЗ рдХрдо `--min` рдпрд╛ `--max` рдЪрд╛рд╣рд┐рдПред

#### `-g`, `--genewise`
рдкреНрд░рддреНрдпреЗрдХ gene рдХреЗ significant phenotype count рдкрд░ рдлрд╝рд┐рд▓реНрдЯрд░ред `genewise_phenotype_annotations.jsonl(.gz)` рдХреЗ рд▓рд┐рдП `-a/--genewise_annotations` рдЖрд╡рд╢реНрдпрдХ рд╣реИред

#### `-p`, `--pairwise`
рдкреНрд░рддреНрдпреЗрдХ pair рдХреЗ shared phenotype count рдкрд░ рдлрд╝рд┐рд▓реНрдЯрд░ред `--in` рди рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

#### `--min MIN`, `--max MAX`
phenotype count рдХреА lower/upper рд╕реАрдорд╛ред рдПрдХ рд╕реАрдорд╛ рднреА рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред

#### `--in PATH_PAIRWISE_ANNOTATIONS`
pairwise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред рди рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

#### `-a PATH_GENEWISE_ANNOTATIONS`, `--genewise_annotations PATH_GENEWISE_ANNOTATIONS`
genewise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред `--genewise` рдХреЗ рд╕рд╛рде рдЖрд╡рд╢реНрдпрдХред

- pairwise shared phenotype counts:
```bash
tsumugi count --pairwise --min 3 --max 20   --in pairwise_similarity_annotations.jsonl.gz   > pairwise_min3_max20.jsonl
```

- gene-level phenotype counts (genewise рдЖрд╡рд╢реНрдпрдХ):
```bash
tsumugi count --genewise --min 5 --max 50   --genewise genewise_phenotype_annotations.jsonl.gz   --in pairwise_similarity_annotations.jsonl.gz   > genewise_min5_max50.jsonl
```

`--min` рдпрд╛ `--max` рдореЗрдВ рд╕реЗ рдХреЗрд╡рд▓ рдПрдХ рднреА рдареАрдХ рд╣реИред

### similarity score рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░ (`tsumugi score`)
```bash
tsumugi score [-h] [--min MIN] [--max MAX] [--in PATH_PAIRWISE_ANNOTATIONS]
```

`phenotype_similarity_score` (0тАУ100) рдХреЗ рдЖрдзрд╛рд░ рдкрд░ gene pairs рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рддрд╛ рд╣реИред рдХрдо рд╕реЗ рдХрдо `--min` рдпрд╛ `--max` рдЪрд╛рд╣рд┐рдПред

#### `--min MIN`, `--max MAX`
score рдХреА lower/upper рд╕реАрдорд╛ред рдПрдХ рд╕реАрдорд╛ рднреА рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред

#### `--in PATH_PAIRWISE_ANNOTATIONS`
pairwise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред рди рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

```bash
tsumugi score --min 50 --max 80   --in pairwise_similarity_annotations.jsonl.gz   > pairwise_score50_80.jsonl
```

`--min` рдпрд╛ `--max` рдореЗрдВ рд╕реЗ рдХреЗрд╡рд▓ рдПрдХ рднреА рдареАрдХ рд╣реИред

### gene list рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░ (`tsumugi genes --keep/--drop`)
```bash
tsumugi genes [-h] (-k GENE_SYMBOL | -d GENE_SYMBOL) [-g | -p] [--in PATH_PAIRWISE_ANNOTATIONS]
```

#### `-k GENE_SYMBOL`, `--keep GENE_SYMBOL`
рдЯреЗрдХреНрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рджрд┐рдП рдЧрдП genes рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ pairs рд╣реА рд░рдЦреЗрдВред

#### `-d GENE_SYMBOL`, `--drop GENE_SYMBOL`
рдЯреЗрдХреНрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рджрд┐рдП рдЧрдП genes рд╡рд╛рд▓реЗ pairs рд╣рдЯрд╛рдПрдБред

#### `-g`, `--genewise`
рдпреВрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рджрд┐рдП рдЧрдП gene symbols рдкрд░ рдлрд╝рд┐рд▓реНрдЯрд░ред

#### `-p`, `--pairwise`
рдпреВрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рджрд┐рдП рдЧрдП gene pairs рдкрд░ рдлрд╝рд┐рд▓реНрдЯрд░ред

#### `--in PATH_PAIRWISE_ANNOTATIONS`
pairwise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред рди рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

```bash
cat << EOF > genes.txt
Maf
Aamp
Cacna1c
EOF

tsumugi genes --genewise --keep genes.txt   --in "$directory"/pairwise_similarity_annotations.jsonl.gz   > pairwise_keep_genes.jsonl

cat << EOF > gene_pairs.csv
Maf,Aamp
Maf,Cacna1c
EOF

tsumugi genes --pairwise --drop gene_pairs.csv   --in pairwise_similarity_annotations.jsonl.gz   > pairwise_drop_genes.jsonl

```

### life stage рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░ (`tsumugi life-stage --keep/--drop`)
```bash
tsumugi life-stage [-h] (-k LIFE_STAGE | -d LIFE_STAGE) [--in PATH_PAIRWISE_ANNOTATIONS]
```

#### `-k LIFE_STAGE`, `--keep LIFE_STAGE`
рдирд┐рд░реНрджрд┐рд╖реНрдЯ life stage (`Embryo`, `Early`, `Interval`, `Late`) рд╣реА рд░рдЦреЗрдВред

#### `-d LIFE_STAGE`, `--drop LIFE_STAGE`
рдирд┐рд░реНрджрд┐рд╖реНрдЯ life stage рд╣рдЯрд╛рдПрдБред

#### `--in PATH_PAIRWISE_ANNOTATIONS`
pairwise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред рди рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

```bash
tsumugi life-stage --keep Early   --in pairwise_similarity_annotations.jsonl.gz   > pairwise_lifestage_early.jsonl
```

### sex рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░ (`tsumugi sex --keep/--drop`)
```bash
tsumugi sex [-h] (-k SEX | -d SEX) [--in PATH_PAIRWISE_ANNOTATIONS]
```

#### `-k SEX`, `--keep SEX`
рдирд┐рд░реНрджрд┐рд╖реНрдЯ sex (`Male`, `Female`, `None`) рд╣реА рд░рдЦреЗрдВред

#### `-d SEX`, `--drop SEX`
рдирд┐рд░реНрджрд┐рд╖реНрдЯ sex рд╣рдЯрд╛рдПрдБред

#### `--in PATH_PAIRWISE_ANNOTATIONS`
pairwise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред рди рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

```bash
tsumugi sex --drop Male   --in pairwise_similarity_annotations.jsonl.gz   > pairwise_no_male.jsonl
```

### zygosity рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░ (`tsumugi zygosity --keep/--drop`)
```bash
tsumugi zygosity [-h] (-k ZYGOSITY | -d ZYGOSITY) [--in PATH_PAIRWISE_ANNOTATIONS]
```

#### `-k ZYGOSITY`, `--keep ZYGOSITY`
рдирд┐рд░реНрджрд┐рд╖реНрдЯ zygosity (`Homo`, `Hetero`, `Hemi`) рд╣реА рд░рдЦреЗрдВред

#### `-d ZYGOSITY`, `--drop ZYGOSITY`
рдирд┐рд░реНрджрд┐рд╖реНрдЯ zygosity рд╣рдЯрд╛рдПрдБред

#### `--in PATH_PAIRWISE_ANNOTATIONS`
pairwise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред рди рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

```bash
tsumugi zygosity --keep Homo   --in pairwise_similarity_annotations.jsonl.gz   > pairwise_homo.jsonl
```

### GraphML / webapp рдПрдХреНрд╕рдкреЛрд░реНрдЯ
```bash
tsumugi build-graphml [-h] [--in PATH_PAIRWISE_ANNOTATIONS] -a PATH_GENEWISE_ANNOTATIONS
```

#### `--in PATH_PAIRWISE_ANNOTATIONS`
pairwise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред рди рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

#### `-a PATH_GENEWISE_ANNOTATIONS`, `--genewise_annotations PATH_GENEWISE_ANNOTATIONS`
genewise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред рдЖрд╡рд╢реНрдпрдХред

```bash
tsumugi build-graphml   --in pairwise_similarity_annotations.jsonl.gz   --genewise genewise_phenotype_annotations.jsonl.gz   > network.graphml
```

```bash
tsumugi build-webapp [-h] [--in PATH_PAIRWISE_ANNOTATIONS] -a PATH_GENEWISE_ANNOTATIONS -o OUT
```

#### `--in PATH_PAIRWISE_ANNOTATIONS`
pairwise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред рди рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

#### `-a PATH_GENEWISE_ANNOTATIONS`, `--genewise_annotations PATH_GENEWISE_ANNOTATIONS`
genewise annotation рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрд╛рдеред рдЖрд╡рд╢реНрдпрдХред

#### `-o OUT`, `--out OUT`
webapp bundle (HTML/CSS/JS + рдиреЗрдЯрд╡рд░реНрдХ рдбреЗрдЯрд╛) рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реАред рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╡рд╛рд▓рд╛ рдлрд╝рд╛рдЗрд▓ рдирд╛рдо рди рджреЗрдВред

```bash
tsumugi build-webapp   --in pairwise_similarity_annotations.jsonl.gz   --genewise genewise_phenotype_annotations.jsonl.gz   --output_dir ./webapp_output
```

CLI STDIN/STDOUT рд╕рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдк рдХрдорд╛рдВрдб рдЪреЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:  
`zcat pairwise_similarity_annotations.jsonl.gz | tsumugi mp ... | tsumugi genes ... > out.jsonl`

# ЁЯФН рд╕рдорд╛рди рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╡рд╛рд▓реЗ рдЬреАрди рд╕рдореВрд╣ рдХреА рдЧрдгрдирд╛

## рдбреЗрдЯрд╛ рд╕реНрд░реЛрдд

рд╣рдо IMPC рдбреЗрдЯрд╛рд╕реЗрдЯ [Release-23.0](https://ftp.ebi.ac.uk/pub/databases/impc/all-data-releases/release-23.0/results) `statistical-results-ALL.csv.gz` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  
рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЙрд▓рдо рдЬрд╛рдирдХрд╛рд░реА: [Data fields](https://www.mousephenotype.org/help/programmatic-data-access/data-fields/)  

## рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ

KO рдорд╛рдЙрд╕ P-value (`p_value`, `female_ko_effect_p_value` рдпрд╛ `male_ko_effect_p_value`) тЙд 0.0001 рд╡рд╛рд▓реЗ geneтАУphenotype pairs рдирд┐рдХрд╛рд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВред  
- genotype-рд╡рд┐рд╢рд┐рд╖реНрдЯ phenotypes рдХреЛ `homo`, `hetero` рдпрд╛ `hemi` рдХреЗ рд░реВрдк рдореЗрдВ annotate рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  
- sex-рд╡рд┐рд╢рд┐рд╖реНрдЯ phenotypes рдХреЛ `female` рдпрд╛ `male` рдХреЗ рд░реВрдк рдореЗрдВ annotate рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## Phenotypic similarity

TSUMUGI Phenodigm-рдЬреИрд╕реА рдкрджреНрдзрддрд┐ рдЕрдкрдирд╛рддрд╛ рд╣реИ ([Smedley D, et al. (2013)](https://doi.org/10.1093/database/bat025)).  

> [!NOTE]
> рдореВрд▓ Phenodigm рд╕реЗ рдЕрдВрддрд░ рдирд┐рдореНрди рд╣реИрдВред  
> 1. **IC рдХреЗ 5рд╡реЗрдВ рдкрд░рд╕реЗрдВрдЯрд╛рдЗрд▓ рд╕реЗ рдиреАрдЪреЗ рдХреЗ terms рдХреЛ IC=0 рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддрд╛рдХрд┐ рдмрд╣реБрдд рд╕рд╛рдорд╛рдиреНрдп phenotypes (рдЙрджрд╛рд╣рд░рдг: embryo phenotype) рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рди рд╣реЛред**
> 2. **genotype, life stage рдФрд░ sex рдХреЗ metadata matches рдкрд░ рдЖрдзрд╛рд░рд┐рдд weighting рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред**

### 1. MP term-pair similarity рдХреА рдкрд░рд┐рднрд╛рд╖рд╛

* MP ontology рдмрдирд╛рдХрд░ рд╣рд░ term рдХрд╛ Information Content (IC) рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ:  
   `IC(term) = -log((|Descendants(term)| + 1) / |All MP terms|)`  
   IC рдХреЗ 5рд╡реЗрдВ рдкрд░рд╕реЗрдВрдЯрд╛рдЗрд▓ рд╕реЗ рдиреАрдЪреЗ рдХреЗ terms рдХреЛ IC=0 рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

* рдкреНрд░рддреНрдпреЗрдХ MP term pair рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ common ancestor (MICA) рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЙрд╕рдХрд╛ IC Resnik similarity рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред  

* рджреЛ MP terms рдХреЗ ancestor рд╕реЗрдЯ рдХрд╛ Jaccard index рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред  

* MP term-pair similarity рдХреЛ `sqrt(Resnik * Jaccard)` рдХреЗ рд░реВрдк рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### 2. phenotype metadata match рдХреЗ рдЖрдзрд╛рд░ рдкрд░ weighting

* genotype, life stage рдФрд░ sex рдЬреИрд╕реЗ phenotype metadata рдХреЗ рдЕрдиреБрд╕рд╛рд░ weights рд▓рд╛рдЧреВ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

* рд╣рд░ gene pair рдХреЗ рд▓рд┐рдП MP term ├Ч MP term similarity matrix рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  

* genotype/life stage/sex рдХреЗ 0, 1, 2, 3 matches рдХреЗ рд▓рд┐рдП weights 0.2, 0.5, 0.75, 1.0 рд▓рдЧрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВред

### 3. Phenodigm scaling

* Phenodigm-рдЯрд╛рдЗрдк scaling рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ KO рдорд╛рдЙрд╕ рдХреА phenotypic similarity рдХреЛ 0тАУ100 рдореЗрдВ normalize рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:  
   observed max/mean рдирд┐рдХрд╛рд▓рдХрд░ theoretical max/mean рд╕реЗ normalize рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  
   `Score = 100 * (normalized_max + normalized_mean) / 2`  
   рдпрджрд┐ denominator 0 рд╣реЛ, рддреЛ score 0 рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

---

# тЬЙя╕П рд╕рдВрдкрд░реНрдХ
- Google Form: https://forms.gle/ME8EJZZHaRNgKZ979  
- GitHub Issues: https://github.com/akikuno/TSUMUGI-dev/issues/new/choose


---

# ЁЯУД рдЙрджреНрдзрд░рдг

Kuno A, Matsumoto K, Taki T, Takahashi S, and Mizuno S  
**TSUMUGI: a platform for phenotype-driven gene network identification from comprehensive knockout mouse phenotyping data**  
*bioRxiv*. (2026) https://doi.org/10.64898/2026.02.18.706720  
