> тЪая╕П рдпрд╣ AI рджреНрд╡рд╛рд░рд╛чФЯцИР рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЕрдиреБрд╡рд╛рдж рд╣реИ; рдпрджрд┐ рдХреЛрдИчЦСхХП рд╣реЛ рддреЛ рдореВрд▓ (README.md) рджреЗрдЦреЗрдВред  
> рдореВрд▓: https://github.com/akikuno/TSUMUGI-dev/blob/main/README.md

<p align="center">
    <a href="https://larc-tsukuba.github.io/tsumugi/" target="_blank">
        <img src="https://raw.githubusercontent.com/akikuno/TSUMUGI-dev/refs/heads/main/image/tsumugi-logo.jpg" alt="Tsumugi Logo" width="80%">
    </a>
</p>

[![License](https://img.shields.io/badge/License-MIT-9cf.svg)](https://choosealicense.com/licenses/mit/)
[![Test](https://img.shields.io/github/actions/workflow/status/akikuno/tsumugi-dev/pytest.yml?branch=main&label=Test&color=brightgreen)](https://github.com/akikuno/tsumugi-dev/actions)
[![PyPI](https://img.shields.io/pypi/v/tsumugi.svg?label=PyPI&color=orange)](https://pypi.org/project/tsumugi/)
[![Bioconda](https://img.shields.io/conda/v/bioconda/tsumugi?label=Bioconda&color=orange)](https://anaconda.org/bioconda/tsumugi)
[![DOI](https://zenodo.org/badge/441025227.svg)](https://doi.org/10.5281/zenodo.14957711)
[![Contact](https://img.shields.io/badge/Contact-923DE2)](https://forms.gle/ME8EJZZHaRNgKZ979)

**TSUMUGI (Trait-driven Surveillance for Mutation-based Gene module Identification)** [IMPC](https://www.mousephenotype.org/) рдХреЗ KO рдорд╛рдЙрд╕ рдлреЗрдиреЛрдЯрд╛рдЗрдк рдбреЗрдЯрд╛ рд╕реЗ **рдлреЗрдиреЛрдЯрд╛рдЗрдкрд┐рдХ рд╕рдорд╛рдирддрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЬреАрди рдореЙрдбреНрдпреВрд▓ рдирд┐рдХрд╛рд▓рдиреЗ рдФрд░ рджреГрд╢реНрдп рдмрдирд╛рдиреЗ** рдХрд╛ рд╡реЗрдм рдЯреВрд▓ рд╣реИред  
рдпрд╣ рд╡реЗрдм рдкрд░ рд╕рднреА рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рд╣реИЁЯСЗя╕П  
ЁЯФЧhttps://larc-tsukuba.github.io/tsumugi/

**TSUMUGI(ч┤буБО)** рдХрд╛ рдЕрд░реНрде рд╣реИ тАЬрдлреЗрдиреЛрдЯрд╛рдЗрдк рдмрдирд╛рдиреЗ рд╡рд╛рд▓реЗ рдЬреАрди рд╕рдореВрд╣ рдХреЛ рдзрд╛рдЧреЗ рдХреА рддрд░рд╣ рдмреБрдирдирд╛тАЭред

# ЁЯУЦ TSUMUGI рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

TSUMUGI рддреАрди рддрд░рд╣ рдХреЗ рдЗрдирдкреБрдЯ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

### 1. рдлреЗрдиреЛрдЯрд╛рдЗрдк (Phenotype)
рд░реБрдЪрд┐ рдХрд╛ рдлреЗрдиреЛрдЯрд╛рдЗрдк рджрд░реНрдЬ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЙрд╕ рдлреЗрдиреЛрдЯрд╛рдЗрдк рдХреЛ рджрд┐рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ KO рдорд╛рдЙрд╕ рдореЗрдВ **рдХреБрд▓ рдорд┐рд▓рд╛рдХрд░ рд╕рдорд╛рди рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╡рд╛рд▓реЗ рдЬреАрди рд╕рдореВрд╣** рдорд┐рд▓реЗрдВред  
рдлреЗрдиреЛрдЯрд╛рдЗрдк рдирд╛рдо [MPO](https://www.informatics.jax.org/vocab/mp_ontology) рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВред  
ЁЯСЙ [рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕реВрдЪреА](https://github.com/larc-tsukuba/tsumugi/blob/main/data/available_mp_terms.txt)

### 2. рдЬреАрди (Gene)
рдПрдХ рдЬреАрди рджреЗрдВ рдФрд░ **рд╕рдорд╛рди KO рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╡рд╛рд▓реЗ рдЕрдиреНрдп рдЬреАрди рд╕рдореВрд╣** рдЦреЛрдЬреЗрдВред  
рдЬреАрди рдкреНрд░рддреАрдХ [MGI](http://www.informatics.jax.org/) рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИрдВред  
ЁЯСЙ [рдЬреАрди рд╕реВрдЪреА](https://github.com/larc-tsukuba/tsumugi/blob/main/data/available_gene_symbols.txt)

### 3. рдЬреАрди рд╕реВрдЪреА (Gene List)
рдПрдХрд╛рдзрд┐рдХ рдЬреАрди (рдкреНрд░рддрд┐ рдкрдВрдХреНрддрд┐ рдПрдХ) рджреЗрдВ рдФрд░ **рд╕реВрдЪреА рдХреЗ рднреАрддрд░** рд╕рдорд╛рди рдлреЗрдиреЛрдЯрд╛рдЗрдк рдЦреЛрдЬреЗрдВред  
> [!CAUTION]  
> рдпрджрд┐ рдХреЛрдИ рд╕рдорд╛рди рдЬреАрди рдирд╣реАрдВ рдорд┐рд▓рд╛: `No similar phenotypes were found among the entered genes.`  
> рдпрджрд┐ 200 рд╕реЗ рдЕрдзрд┐рдХ рдорд┐рд▓реЗ: `Too many genes submitted. Please limit the number to 200 or fewer.`

### ЁЯУе рдХрдЪреНрдЪрд╛ рдбреЗрдЯрд╛ рдбрд╛рдЙрдирд▓реЛрдб
TSUMUGI gzip-рдХрдВрдкреНрд░реЗрд╕реНрдб JSONL рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

#### `genewise_phenotype_annotations.jsonl.gz`
- рдЬреАрди рдкреНрд░рддреАрдХ (рдЬреИрд╕реЗ "1110059G10Rik")  
- Marker accession ID (рдЬреИрд╕реЗ "MGI:1913452")  
- рдлреЗрдиреЛрдЯрд╛рдЗрдк рдирд╛рдо/ID (рдЬреИрд╕реЗ "fused joints", "MP:0000137")  
- Effect size (рдЬреИрд╕реЗ 0.0, 1.324)  
- Significance (True/false)  
- Zygosity ("Homo", "Hetero", "Hemi")  
- Life stage ("Embryo", "Early", "Interval", "Late")  
- Sexual dimorphism ("", "Male", "Female")  
- Disease annotation (рдЬреИрд╕реЗ [] рдпрд╛ "Premature Ovarian Failure 18")

рдЙрджрд╛рд╣рд░рдг:
```
{"life_stage": "Early", "marker_symbol": "1110059G10Rik", "marker_accession_id": "MGI:1913452", "effect_size": 0.0, "mp_term_name": "fused joints", "disease_annotation": [], "significant": false, "zygosity": "Homo", "sexual_dimorphism": "", "mp_term_id": "MP:0000137"}
```

#### `pairwise_similarity_annotations.jsonl.gz`
- рдЬреАрди рдпреБрдЧреНрдо (`gene1_symbol`, `gene2_symbol`)  
- `phenotype_shared_annotations` (рдЬреАрд╡рди рдЪрд░рдг, zygosity, рдпреМрди рджреНрд╡рд┐рд░реВрдкрддрд╛ рдЬреИрд╕реЗ рдореЗрдЯрд╛рдбреЗрдЯрд╛)  
- `phenotype_similarity_score` (Resnik-рдЖрдзрд╛рд░рд┐рдд Phenodigm рд╕реНрдХреЛрд░, 0тАУ100)

рдЙрджрд╛рд╣рд░рдг:
```
{"gene1_symbol": "1110059G10Rik", "gene2_symbol": "Cog6", "phenotype_shared_annotations": {"vertebral transformation": {"zygosity": "Homo", "life_stage": "Early", "sexual_dimorphism": "Male"}}, "phenotype_similarity_score": 42}
```

# ЁЯМР рдиреЗрдЯрд╡рд░реНрдХ

рдЗрдирдкреБрдЯ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкреЗрдЬ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛрдХрд░ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрд╡рддрдГ рдмрдирддрд╛ рд╣реИред

> [!IMPORTANT]  
> **3 рдпрд╛ рдЕрдзрд┐рдХ рд╕рд╛рдЭрд╛ рдЕрд╕рд╛рдорд╛рдиреНрдп рдлреЗрдиреЛрдЯрд╛рдЗрдк** рддрдерд╛ **рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕рдорд╛рдирддрд╛ > 0.0** рд╡рд╛рд▓реЗ рдЬреАрди рдпреБрдЧреНрдо рджреГрд╢реНрдп рдореЗрдВ рджрд┐рдЦрддреЗ рд╣реИрдВред

### рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдирд▓
**рдиреЛрдб** рдЬреАрди рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВред рдХреНрд▓рд┐рдХ рдкрд░ KO рдорд╛рдЙрд╕ рдореЗрдВ рджреЗрдЦреЗ рдЧрдП рдЕрд╕рд╛рдорд╛рдиреНрдп рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕реВрдЪреА рджрд┐рдЦрддреА рд╣реИ; рдбреНрд░реИрдЧ рд╕реЗ рд╕реНрдерд╛рди рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВред  
**рдПрдЬ** рдХреНрд▓рд┐рдХ рдкрд░ рд╕рд╛рдЭрд╛ рдлреЗрдиреЛрдЯрд╛рдЗрдк рдХрд╛ рд╡рд┐рд╡рд░рдг рджрд┐рдЦрддрд╛ рд╣реИред

### рдХрдВрдЯреНрд░реЛрд▓ рдкреИрдирд▓
рдмрд╛рдПрдБ эМиыДР рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ эСЬьЛЬ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВред

#### рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕рдорд╛рдирддрд╛ рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░
`Phenotypes similarity` рд╕реНрд▓рд╛рдЗрдбрд░ ResnikтЖТPhenodigm рд╕реНрдХреЛрд░ рд╕реЗ рдПрдЬьЭШ ьЮДъ│Дъ░ТьЭД ьДдьаХэХйыЛИыЛдуАВ  
> ъ│ДьВ░ ы░йы▓Х: ЁЯСЙ [ЁЯФН эСЬэШДэШХ ьЬаьВм ьЬаьаДьЮРъ╡░ ъ│ДьВ░](#-эСЬэШДэШХ-ьЬаьВм-ьЬаьаДьЮРъ╡░-ъ│ДьВ░)

#### рдлреЗрдиреЛрдЯрд╛рдЗрдк рдЧрдВрднреАрд░рддрд╛ рд╕реЗ эХДреНрдЯрд░
`Phenotype severity` рд╕реНрд▓рд╛рдЗрдбрд░ KO рдорд╛рдЙрд╕ рдореЗрдВ эЪиъ│╝ыЯЙ(ьдСьжЭыПД)ьЬ╝ыбЬ ыЕ╕ыУЬ эХДэД░ызБэХйыЛИыЛдуАВъ░ТьЭ┤ эБ┤ьИШыбЭ ьШБэЦеьЭ┤ эБ╜ыЛИыЛдуАВ  
> ьЭ┤ьзД эСЬэШДэШХ(ьШИ: [abnormal embryo development](https://larc-tsukuba.github.io/tsumugi/app/phenotype/abnormal_embryo_development.html); ьЭ┤ьзД ыкйыбЭьЭА [ьЧмъ╕░](https://github.com/larc-tsukuba/tsumugi/blob/main/data/binary_phenotypes.txt))ыВШ ыЛиьЭ╝ ьЬаьаДьЮР ьЮЕыае ьЛЬьЧРыКФ ьИиъ▓иьзСыЛИыЛдуАВ

#### Genotype ьзАьаХ
- `Homo`(ыПЩэШХьаСэХй)
- `Hetero`(ьЭ┤эШХьаСэХй)
- `Hemi`(ы░Шь╕бьаСэХй)

#### ьД▒ы│Д ьзАьаХ
- `Female`
- `Male`

#### ыЭ╝ьЭ┤эФД ьКдэЕМьЭ┤ьзА ьзАьаХ
- `Embryo`
- `Early`(0тАУ16ьг╝)
- `Interval`(17тАУ48ьг╝)
- `Late`(49ьг╝ ьЭ┤ьГБ)

### ызИэБмьЧЕ эМиыДР
#### Highlight: Human Disease
IMPC Disease Models Portal ыН░ьЭ┤эД░ыбЬ ьзИы│С ъ┤Аыаи ьЬаьаДьЮРые╝ эХШьЭ┤ыЭ╝ьЭ┤эК╕эХйыЛИыЛдуАВ

#### Search: Specific Gene
ыДдэК╕ьЫМэБмьЧРьДЬ ьЬаьаДьЮРыкЕьЭД ъ▓АьГЙэХйыЛИыЛдуАВ

#### Layout & Display
ыаИьЭ┤ьХДьЫГ, эП░эК╕ эБмъ╕░, ьЧгьзА ыСРъ╗Ш, ыЕ╕ыУЬ ы░Шы░Ьыае(Cose ыаИьЭ┤ьХДьЫГ) ьб░ьаХуАВ

#### Export
PNG/CSV/GraphMLыбЬ ыВ┤ы│┤ыВ╝ ьИШ ьЮИьК╡ыЛИыЛдуАВ  
CSVьЧРыКФ ыкиыУИIDьЩА ъ░Б ьЬаьаДьЮР эСЬэШДэШХ ыжмьКдэК╕ъ░А эПмэХиыРШъ│а, GraphMLьЭА Cytoscape эШ╕эЩШьЮЕыЛИыЛдуАВ

# ЁЯЫа ь╗дызиыУЬыЭ╝ьЭ╕ ы▓ДьаД

ьЭ┤ы▓И ыж┤ыжмьКдьЧРьДЬ **CLI**ые╝ ь╢Фъ░АэЦИьК╡ыЛИыЛдуАВь╡ЬьЛа IMPC ыН░ьЭ┤эД░ые╝ ы░ЫьХД ьКдьКдыбЬ эММьЭ┤эФДыЭ╝ьЭ╕ьЭД ьЛдэЦЙэХШъ│а, ьЫ╣ы│┤ыЛд ыНФ ьД╕ы░АэХЬ эХДэД░ьЩА ь╢Ьыае ьШ╡ьЕШьЭД ьаБьЪйэХа ьИШ ьЮИьК╡ыЛИыЛдуАВ

- IMPC `statistical-results-ALL.csv.gz`(ьШ╡ьЕШ `mp.obo`, `impc_phenodigm.csv`)ыбЬ ьЮмъ│ДьВ░  
- MP ьЪйьЦ┤ эПмэХи/ьаЬьЩ╕ эХДэД░  
- ьЬаьаДьЮР ыжмьКдэК╕(ьЙ╝эСЬ ыШРыКФ эЕНьКдэК╕ эММьЭ╝)ыбЬ эХДэД░  
- ь╢Ьыае: GraphML(`tsumugi build-graphml`), ьШдэФДыЭ╝ьЭ╕ ьЫ╣ьХ▒ ы▓ИыУд(`tsumugi build-webapp`)

## ьВмьЪй ъ░АыКеэХЬ ыкЕыа╣
- `tsumugi run`: IMPC ыН░ьЭ┤эД░ыбЬ ыДдэК╕ьЫМэБм ьЮмъ│ДьВ░  
- `tsumugi mp --include/--exclude`: MP ьЪйьЦ┤ эПмэХи/ып╕эСЬьЛЬ эОШьЦ┤ эХДэД░  
- `tsumugi n-phenos --pairwise/--genewise (--min/--max)`: эСЬэШДэШХ ьИШыбЬ эХДэД░(эОШьЦ┤/ьЬаьаДьЮР)  
- `tsumugi genes --keep/--drop`: ьЬаьаДьЮР ыжмьКдэК╕ыбЬ ьЬаьзА/ьВньаЬ  
- `tsumugi life-stage --keep/--drop`: ыЭ╝ьЭ┤эФД ьКдэЕМьЭ┤ьзА эХДэД░  
- `tsumugi sex --keep/--drop`: ьД▒ы│Д эХДэД░  
- `tsumugi zygosity --keep/--drop`: ьаСэХйэШХ эХДэД░  
- `tsumugi build-graphml`: GraphML ьГЭьД▒  
- `tsumugi build-webapp`: TSUMUGI ьЫ╣ьХ▒ ьЮРьВ░ ьГЭьД▒

## ьДдь╣Ш
BioConda:
```bash
conda install -c conda-forge -c bioconda tsumugi
```
PyPI:
```bash
pip install tsumugi
```
`tsumugi --version`ьЭ┤ ы│┤ьЭ┤ый┤ ьдАы╣Д ьЩДыгМьЮЕыЛИыЛдуАВ

## ьг╝ьЪФ ьВмьЪй ьШИ(ыкЕыа╣ы│Д)

### 1. IMPC ыН░ьЭ┤эД░ыбЬ ьЮмъ│ДьВ░(`tsumugi run`)
`--mp_obo`ые╝ ьГЭыЮ╡эХШый┤ ыПЩы┤ЙыРЬ `data-version: releases/2025-08-27/mp.obo`ые╝ ьВмьЪйэХйыЛИыЛдуАВ  
`--impc_phenodigm`ьЭД ьГЭыЮ╡эХШый┤ 2025-10-01ьЧР IMPC Disease Models PortalьЧРьДЬ ы░ЫьЭА эММьЭ╝ьЭД ьВмьЪйэХйыЛИыЛдуАВ
```bash
tsumugi run \
  --output_dir ./tsumugi-output \
  --statistical_results ./statistical-results-ALL.csv.gz \
  --threads 8
```
ь╢Ьыае: `./tsumugi-output`ьЧР genewise/pairwise JSONLъ│╝ `TSUMUGI-webapp`ьЭ┤ ьГЭьД▒ыРйыЛИыЛдуАВ

> [!IMPORTANT]  
> `TSUMUGI-webapp`ьЧРыКФ OSы│Д ьЛдэЦЙ ьКдэБмыж╜эК╕ъ░А эПмэХиыРШьЦ┤ ьЮИьК╡ыЛИыЛдуАВыНФы╕ФэБ┤ыжньЬ╝ыбЬ ыбЬь╗м ьЫ╣ьХ▒ьЭД ьЧ┤ ьИШ ьЮИьК╡ыЛИыЛдуАВ  
> - Windows: `open_webapp_windows.bat`  
> - macOS: `open_webapp_mac.command`  
> - Linux: `open_webapp_linux.sh`

### 2. MP ьЪйьЦ┤ эХДэД░(`tsumugi mp --include/--exclude`)
ъ┤АьЛм ьЮИыКФ эСЬэШДэШХьЭД ъ░АьзД ьЬаьаДьЮР эОШьЦ┤ызМ ь╢Фь╢ЬэХШъ▒░ыВШ, эХ┤ыЛ╣ эСЬэШДэШХьЭД ь╕бьаХэЦИьзАызМ ьЬаьЭШэХЬ ьЭ┤ьГБьЭ┤ ьЧЖьЧИыНШ ьЬаьаДьЮР эОШьЦ┤ые╝ ь╢Фь╢ЬэХа ьИШ ьЮИьК╡ыЛИыЛдуАВ

```bash
# MP:0001146(abnormal testis morphology)ьЩА ъ╖╕ эХШьЬД эСЬэШДэШХ(MP:0004849 (abnormal testis size) ыУ▒)ьЭД эПмэХиэХШыКФ ьЬаьаДьЮР эОШьЦ┤ызМ ь╢Фь╢Ь
tsumugi mp --include MP:0001146 \
  --in pairwise_similarity_annotations.jsonl.gz \
  > pairwise_filtered.jsonl

# MP:0001146(abnormal testis morphology)ьЩА ъ╖╕ эХШьЬД эСЬэШДэШХ(MP:0004849 (abnormal testis size) ыУ▒)ьЭД ь╕бьаХэЦИьзАызМ ьЬаьЭШэХЬ ьЭ┤ьГБьЭ┤ ьЧЖьЧИыНШ ьЬаьаДьЮР эОШьЦ┤ые╝ ь╢Фь╢Ь
tsumugi mp --exclude MP:0001146 \
  --genewise genewise_phenotype_annotations.jsonl.gz \
  --in pairwise_similarity_annotations.jsonl.gz \
  > pairwise_filtered.jsonl
```

> [!IMPORTANT]
> **ьзАьаХэХЬ MP ьЪйьЦ┤ьЭШ эХШьЬД ьЪйьЦ┤ыПД эХиъ╗Ш ь▓ШыжмыРйыЛИыЛд.**  
> ьШИые╝ ыУдьЦ┤ `MP:0001146 (abnormal testis morphology)`ые╝ ьзАьаХэХШый┤ `MP:0004849 (abnormal testis size)` ыУ▒ьЭШ эХШьЬД ьЪйьЦ┤ыПД ъ│аыадыРйыЛИыЛдуАВ

### 3. эСЬэШДэШХ ьИШ эХДэД░(`tsumugi n-phenos`)
- эОШьЦ┤ыЛ╣ ъ│╡ьЬа эСЬэШДэШХ:
```bash
tsumugi n-phenos --pairwise --min 3 --max 20 \
  --in pairwise_similarity_annotations.jsonl.gz \
  > pairwise_min3_max20.jsonl
```
- ьЬаьаДьЮРы│Д эСЬэШДэШХ( genewise эХДьЪФ ):
```bash
tsumugi n-phenos --genewise --min 5 --max 50 \
  --genewise genewise_phenotype_annotations.jsonl.gz \
  --in pairwise_similarity_annotations.jsonl.gz \
  > genewise_min5_max50.jsonl
```
`--min` ыШРыКФ `--max` ыЛиыПЕ ьВмьЪйыПД ъ░АыКеэХйыЛИыЛдуАВ

### 4. ьЬаьаДьЮР ыжмьКдэК╕ эХДэД░(`tsumugi genes --keep/--drop`)
```bash
tsumugi genes --keep genes.txt \
  --in pairwise_similarity_annotations.jsonl.gz \
  > pairwise_keep_genes.jsonl

tsumugi genes --drop geneA,geneB \
  --in pairwise_similarity_annotations.jsonl.gz \
  > pairwise_drop_genes.jsonl
```

### 5. ыЭ╝ьЭ┤эФД ьКдэЕМьЭ┤ьзА / ьД▒ы│Д / ьаСэХйэШХ
```bash
tsumugi life-stage --keep Early --in pairwise_similarity_annotations.jsonl.gz > pairwise_lifestage_early.jsonl
tsumugi sex --drop Male --in pairwise_similarity_annotations.jsonl.gz > pairwise_no_male.jsonl
tsumugi zygosity --keep Homo --in pairwise_similarity_annotations.jsonl.gz > pairwise_homo.jsonl
```

### 6. GraphML / ьЫ╣ьХ▒ ьГЭьД▒
```bash
tsumugi build-graphml \
  --in pairwise_similarity_annotations.jsonl.gz \
  --genewise genewise_phenotype_annotations.jsonl.gz \
  > network.graphml

tsumugi build-webapp \
  --in pairwise_similarity_annotations.jsonl.gz \
  --genewise genewise_phenotype_annotations.jsonl.gz \
  --output_dir ./webapp_output
```

эММьЭ┤эФД ьШИ: `zcat ... | tsumugi mp ... | tsumugi genes ... > out.jsonl`

# ЁЯФН ыПЩьЭ╝ эСЬэШДэШХ ьЬаьаДьЮРъ╡░ ъ│ДьВ░

## ыН░ьЭ┤эД░ ьЖМьКд
[IMPC Release-23.0](https://ftp.ebi.ac.uk/pub/databases/impc/all-data-releases/release-23.0/results) `statistical-results-ALL.csv.gz`  
эХДыУЬ: [Data fields](https://www.mousephenotype.org/help/programmatic-data-access/data-fields/)

## ьаДь▓Шыжм
P тЙд 0.0001(`p_value`, `female_ko_effect_p_value`, `male_ko_effect_p_value`)ьЭ╕ ьЬаьаДьЮРтАУэСЬэШДэШХ ь╢Фь╢Ь  
- Zygosity: `homo`, `hetero`, `hemi`  
- Sex: `female`, `male`

## эСЬэШДэШХ ьЬаьВмыПД
MP ьЪйьЦ┤ ъ░Д **Resnik** ьЬаьВмыПДые╝ ъ│ДьВ░эХШъ│а, **Phenodigm(0тАУ100)**ьЬ╝ыбЬ ьКдь╝АьЭ╝ызБэХйыЛИыЛдуАВ

1. MP ьШиэЖиыбЬьзА ъ╡мь╢Х, IC ъ│ДьВ░: `IC(term) = -log((|Descendants(term)| + 1) / |All MP terms|)`  
2. Resnik(t1, t2) = ъ░АьЮе ьаХы│┤ъ░А эБ░ ъ│╡эЖ╡ ьб░ьГБ(MICA)ьЭШ IC(ьЧЖьЬ╝ый┤ 0)  
3. ьЬаьаДьЮР ьМН: zygosity/ыЭ╝ьЭ┤эФДьКдэЕМьЭ┤ьзА/ьД▒ы│Д ьЭ╝ь╣ШыПД(1.0/0.75/0.5/0.25)ыбЬ ъ░АьдС  
4. ьЛдьаЬ max/meanьЭД ьЭ┤ыбаьаБ max/meanьЬ╝ыбЬ ыВШыИИ ыТд эПЙъ╖а:  
   `Phenodigm = 100 * 0.5 * ( actual_max / theoretical_max + actual_mean / theoretical_mean )`  
   ы╢Дыки 0ьЭ┤ый┤ 0ьЬ╝ыбЬ ьДдьаХ. 0тАУ100 ьаРьИШыКФ ыЛдьЪ┤ыбЬыУЬ ы░П `Phenotypes similarity` ьКмыЭ╝ьЭ┤ыНФьЧР ьВмьЪйыРйыЛИыЛдуАВ

# тЬЙя╕П ьЧ░ыЭ╜
- Google Form: https://forms.gle/ME8EJZZHaRNgKZ979  
- GitHub Issues: https://github.com/akikuno/TSUMUGI-dev/issues/new/choose
