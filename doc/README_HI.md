> тЪая╕П рдпрд╣ AI рджреНрд╡рд╛рд░рд╛чФЯцИР рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЕрдиреБрд╡рд╛рдж рд╣реИ; рдпрджрд┐ рдХреЛрдИчЦСхХП рд╣реЛ рддреЛ рдореВрд▓ (README.md) рджреЗрдЦреЗрдВред  
> рдореВрд▓: https://github.com/akikuno/TSUMUGI-dev/blob/main/README.md

<p align="center">
    <a href="https://larc-tsukuba.github.io/tsumugi/" target="_blank">
        <img src="https://raw.githubusercontent.com/akikuno/TSUMUGI-dev/refs/heads/main/image/tsumugi-logo.jpg" alt="Tsumugi Logo" width="80%">
    </a>
</p>

[![License](https://img.shields.io/badge/License-MIT-9cf.svg)](https://choosealicense.com/licenses/mit/)
[![Test](https://img.shields.io/github/actions/workflow/status/akikuno/tsumugi-dev/pytest.yml?branch=main&label=Test&color=brightgreen)](https://github.com/akikuno/tsumugi-dev/actions)
[![PyPI](https://img.shields.io/pypi/v/tsumugi.svg?label=PyPI&color=orange)](https://pypi.org/project/tsumugi/)
[![Bioconda](https://img.shields.io/conda/v/bioconda/tsumugi?label=Bioconda&color=orange)](https://anaconda.org/bioconda/tsumugi)
[![DOI](https://zenodo.org/badge/441025227.svg)](https://doi.org/10.5281/zenodo.14957711)
[![Contact](https://img.shields.io/badge/Contact-923DE2)](https://forms.gle/ME8EJZZHaRNgKZ979)

**TSUMUGI (Trait-driven Surveillance for Mutation-based Gene module Identification)** [IMPC](https://www.mousephenotype.org/) рдХреЗ KO рдорд╛рдЙрд╕ рдлреЗрдиреЛрдЯрд╛рдЗрдк рдбреЗрдЯрд╛ рд╕реЗ **рдлреЗрдиреЛрдЯрд╛рдЗрдкрд┐рдХ рд╕рдорд╛рдирддрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЬреАрди рдореЙрдбреНрдпреВрд▓ рдирд┐рдХрд╛рд▓рдиреЗ рдФрд░ рджреГрд╢реНрдп рдмрдирд╛рдиреЗ** рдХрд╛ рд╡реЗрдм рдЯреВрд▓ рд╣реИред  
рдпрд╣ рд╡реЗрдм рдкрд░ рд╕рднреА рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рд╣реИЁЯСЗя╕П  
ЁЯФЧhttps://larc-tsukuba.github.io/tsumugi/

**TSUMUGI(ч┤буБО)** рдХрд╛ рдЕрд░реНрде рд╣реИ тАЬрдлреЗрдиреЛрдЯрд╛рдЗрдк рдмрдирд╛рдиреЗ рд╡рд╛рд▓реЗ рдЬреАрди рд╕рдореВрд╣ рдХреЛ рдзрд╛рдЧреЗ рдХреА рддрд░рд╣ рдмреБрдирдирд╛тАЭред

# ЁЯУЦ TSUMUGI рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

TSUMUGI рддреАрди рддрд░рд╣ рдХреЗ рдЗрдирдкреБрдЯ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

### рдлреЗрдиреЛрдЯрд╛рдЗрдк (Phenotype)
рд░реБрдЪрд┐ рдХрд╛ рдлреЗрдиреЛрдЯрд╛рдЗрдк рджрд░реНрдЬ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЙрд╕ рдлреЗрдиреЛрдЯрд╛рдЗрдк рдХреЛ рджрд┐рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ KO рдорд╛рдЙрд╕ рдореЗрдВ **рдХреБрд▓ рдорд┐рд▓рд╛рдХрд░ рд╕рдорд╛рди рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╡рд╛рд▓реЗ рдЬреАрди рд╕рдореВрд╣** рдорд┐рд▓реЗрдВред  
рдлреЗрдиреЛрдЯрд╛рдЗрдк рдирд╛рдо [MPO](https://www.informatics.jax.org/vocab/mp_ontology) рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВред  
ЁЯСЙ [рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕реВрдЪреА](https://github.com/larc-tsukuba/tsumugi/blob/main/data/available_mp_terms.txt)

### рдЬреАрди (Gene)
рдПрдХ рдЬреАрди рджреЗрдВ рдФрд░ **рд╕рдорд╛рди KO рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╡рд╛рд▓реЗ рдЕрдиреНрдп рдЬреАрди рд╕рдореВрд╣** рдЦреЛрдЬреЗрдВред  
рдЬреАрди рдкреНрд░рддреАрдХ [MGI](http://www.informatics.jax.org/) рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИрдВред  
ЁЯСЙ [рдЬреАрди рд╕реВрдЪреА](https://github.com/larc-tsukuba/tsumugi/blob/main/data/available_gene_symbols.txt)

### рдЬреАрди рд╕реВрдЪреА (Gene List)
рдПрдХрд╛рдзрд┐рдХ рдЬреАрди (рдкреНрд░рддрд┐ рдкрдВрдХреНрддрд┐ рдПрдХ) рджреЗрдВ рдФрд░ **рд╕реВрдЪреА рдХреЗ рднреАрддрд░** рд╕рдорд╛рди рдлреЗрдиреЛрдЯрд╛рдЗрдк рдЦреЛрдЬреЗрдВред  
> [!CAUTION]  
> рдпрджрд┐ рдХреЛрдИ рд╕рдорд╛рди рдЬреАрди рдирд╣реАрдВ рдорд┐рд▓рд╛: `No similar phenotypes were found among the entered genes.`  
> рдпрджрд┐ 200 рд╕реЗ рдЕрдзрд┐рдХ рдорд┐рд▓реЗ: `Too many genes submitted. Please limit the number to 200 or fewer.`

### ЁЯУе рдХрдЪреНрдЪрд╛ рдбреЗрдЯрд╛ рдбрд╛рдЙрдирд▓реЛрдб
TSUMUGI gzip-рдХрдВрдкреНрд░реЗрд╕реНрдб JSONL рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

#### `genewise_phenotype_annotations.jsonl.gz`
- рдЬреАрди рдкреНрд░рддреАрдХ (рдЬреИрд╕реЗ "1110059G10Rik")  
- Marker accession ID (рдЬреИрд╕реЗ "MGI:1913452")  
- рдлреЗрдиреЛрдЯрд╛рдЗрдк рдирд╛рдо/ID (рдЬреИрд╕реЗ "fused joints", "MP:0000137")  
- Effect size (рдЬреИрд╕реЗ 0.0, 1.324)  
- Significance (True/false)  
- Zygosity ("Homo", "Hetero", "Hemi")  
- Life stage ("Embryo", "Early", "Interval", "Late")  
- Sexual dimorphism ("", "Male", "Female")  
- Disease annotation (рдЬреИрд╕реЗ [] рдпрд╛ "Premature Ovarian Failure 18")

рдЙрджрд╛рд╣рд░рдг:
```
{"significant": true, "sexual_dimorphism": "Female", "effect_size": 0.0119677350763567, "marker_symbol": "4930447C04Rik", "zygosity": "Homo", "marker_accession_id": "MGI:1923051", "mp_term_id": "MP:0000063", "disease_annotation": ["Male Infertility With Azoospermia Or Oligozoospermia Due To Single Gene Mutation", "Premature Ovarian Failure 18", "Spermatogenic Failure 52"], "life_stage": "Early", "mp_term_name": "decreased bone mineral density"}
```

#### `pairwise_similarity_annotations.jsonl.gz`
- рдЬреАрди рдпреБрдЧреНрдо (`gene1_symbol`, `gene2_symbol`)  
- `phenotype_shared_annotations` (рдЬреАрд╡рди рдЪрд░рдг, zygosity, рдпреМрди рджреНрд╡рд┐рд░реВрдкрддрд╛ рдЬреИрд╕реЗ рдореЗрдЯрд╛рдбреЗрдЯрд╛)  
- `phenotype_similarity_score` (Resnik-рдЖрдзрд╛рд░рд┐рдд Phenodigm рд╕реНрдХреЛрд░, 0тАУ100)

рдЙрджрд╛рд╣рд░рдг:
```
{"gene1_symbol": "1500009L16Rik", "gene2_symbol": "Aak1", "phenotype_shared_annotations": [{"mp_term_name": "increased circulating enzyme level", "life_stage": "Early", "zygosity": "Homo", "sexual_dimorphism": "None"}], "phenotype_similarity_score": 47}
```

# ЁЯМР рдиреЗрдЯрд╡рд░реНрдХ

рдЗрдирдкреБрдЯ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкреЗрдЬ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛрдХрд░ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрд╡рддрдГ рдмрдирддрд╛ рд╣реИред

> [!IMPORTANT]  
> **3 рдпрд╛ рдЕрдзрд┐рдХ рд╕рд╛рдЭрд╛ рдЕрд╕рд╛рдорд╛рдиреНрдп рдлреЗрдиреЛрдЯрд╛рдЗрдк** рддрдерд╛ **рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕рдорд╛рдирддрд╛ > 0.0** рд╡рд╛рд▓реЗ рдЬреАрди рдпреБрдЧреНрдо рджреГрд╢реНрдп рдореЗрдВ рджрд┐рдЦрддреЗ рд╣реИрдВред

### рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдирд▓
**рдиреЛрдб** рдЬреАрди рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВред рдХреНрд▓рд┐рдХ рдкрд░ KO рдорд╛рдЙрд╕ рдореЗрдВ рджреЗрдЦреЗ рдЧрдП рдЕрд╕рд╛рдорд╛рдиреНрдп рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕реВрдЪреА рджрд┐рдЦрддреА рд╣реИ; рдбреНрд░реИрдЧ рд╕реЗ рд╕реНрдерд╛рди рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВред  
**рдПрдЬ** рдХреНрд▓рд┐рдХ рдкрд░ рд╕рд╛рдЭрд╛ рдлреЗрдиреЛрдЯрд╛рдЗрдк рдХрд╛ рд╡рд┐рд╡рд░рдг рджрд┐рдЦрддрд╛ рд╣реИред
**Modules** outline gene subnetworks. Click a module to list phenotypes of its genes; drag modules to reposition and avoid overlap.

### рдХрдВрдЯреНрд░реЛрд▓ рдкреИрдирд▓
рдмрд╛рдПрдБ эМиыДР рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ эСЬьЛЬ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВред

#### рдлреЗрдиреЛрдЯрд╛рдЗрдк рд╕рдорд╛рдирддрд╛ рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░
`Phenotypes similarity` рд╕реНрд▓рд╛рдЗрдбрд░ ResnikтЖТPhenodigm рд╕реНрдХреЛрд░ рд╕реЗ рдПрдЬьЭШ ьЮДъ│Дъ░ТьЭД ьДдьаХэХйыЛИыЛдуАВ  
> ъ│ДьВ░ ы░йы▓Х: ЁЯСЙ [ЁЯФН эСЬэШДэШХ ьЬаьВм ьЬаьаДьЮРъ╡░ ъ│ДьВ░](#-эСЬэШДэШХ-ьЬаьВм-ьЬаьаДьЮРъ╡░-ъ│ДьВ░)

#### рдлреЗрдиреЛрдЯрд╛рдЗрдк рдЧрдВрднреАрд░рддрд╛ рд╕реЗ эХДреНрдЯрд░
`Phenotype severity` рд╕реНрд▓рд╛рдЗрдбрд░ KO рдорд╛рдЙрд╕ рдореЗрдВ эЪиъ│╝ыЯЙ(ьдСьжЭыПД)ьЬ╝ыбЬ ыЕ╕ыУЬ эХДэД░ызБэХйыЛИыЛдуАВъ░ТьЭ┤ эБ┤ьИШыбЭ ьШБэЦеьЭ┤ эБ╜ыЛИыЛдуАВ  
> ьЭ┤ьзД эСЬэШДэШХ(ьШИ: [abnormal embryo development](https://larc-tsukuba.github.io/tsumugi/app/phenotype/abnormal_embryo_development.html); ьЭ┤ьзД ыкйыбЭьЭА [ьЧмъ╕░](https://github.com/larc-tsukuba/tsumugi/blob/main/data/binary_phenotypes.txt))ыВШ ыЛиьЭ╝ ьЬаьаДьЮР ьЮЕыае ьЛЬьЧРыКФ ьИиъ▓иьзСыЛИыЛдуАВ

#### Genotype ьзАьаХ
- `Homo`(ыПЩэШХьаСэХй)
- `Hetero`(ьЭ┤эШХьаСэХй)
- `Hemi`(ы░Шь╕бьаСэХй)

#### ьД▒ы│Д ьзАьаХ
- `Female`
- `Male`

#### ыЭ╝ьЭ┤эФД ьКдэЕМьЭ┤ьзА ьзАьаХ
- `Embryo`
- `Early`(0тАУ16ьг╝)
- `Interval`(17тАУ48ьг╝)
- `Late`(49ьг╝ ьЭ┤ьГБ)

### ызИэБмьЧЕ эМиыДР
#### Highlight: Human Disease
IMPC Disease Models Portal ыН░ьЭ┤эД░ыбЬ ьзИы│С ъ┤Аыаи ьЬаьаДьЮРые╝ эХШьЭ┤ыЭ╝ьЭ┤эК╕эХйыЛИыЛдуАВ

#### Search: Specific Gene
ыДдэК╕ьЫМэБмьЧРьДЬ ьЬаьаДьЮРыкЕьЭД ъ▓АьГЙэХйыЛИыЛдуАВ

#### Layout & Display
ыаИьЭ┤ьХДьЫГ, эП░эК╕ эБмъ╕░, ьЧгьзА ыСРъ╗Ш, ыЕ╕ыУЬ ы░Шы░Ьыае(Cose ыаИьЭ┤ьХДьЫГ) ьб░ьаХуАВ

#### Export
PNG/CSV/GraphMLыбЬ ыВ┤ы│┤ыВ╝ ьИШ ьЮИьК╡ыЛИыЛдуАВ  
CSVьЧРыКФ ыкиыУИIDьЩА ъ░Б ьЬаьаДьЮР эСЬэШДэШХ ыжмьКдэК╕ъ░А эПмэХиыРШъ│а, GraphMLьЭА Cytoscape эШ╕эЩШьЮЕыЛИыЛдуАВ

# ЁЯЫа ь╗дызиыУЬыЭ╝ьЭ╕ ы▓ДьаД

ьЭ┤ы▓И ыж┤ыжмьКдьЧРьДЬ **CLI**ые╝ ь╢Фъ░АэЦИьК╡ыЛИыЛдуАВь╡ЬьЛа IMPC ыН░ьЭ┤эД░ые╝ ы░ЫьХД ьКдьКдыбЬ эММьЭ┤эФДыЭ╝ьЭ╕ьЭД ьЛдэЦЙэХШъ│а, ьЫ╣ы│┤ыЛд ыНФ ьД╕ы░АэХЬ эХДэД░ьЩА ь╢Ьыае ьШ╡ьЕШьЭД ьаБьЪйэХа ьИШ ьЮИьК╡ыЛИыЛдуАВ

- IMPC `statistical-results-ALL.csv.gz`(ьШ╡ьЕШ `mp.obo`, `impc_phenodigm.csv`)ыбЬ ьЮмъ│ДьВ░  
- MP ьЪйьЦ┤ эПмэХи/ьаЬьЩ╕ эХДэД░  
- ьЬаьаДьЮР ыжмьКдэК╕(ьЙ╝эСЬ ыШРыКФ эЕНьКдэК╕ эММьЭ╝)ыбЬ эХДэД░  
- ь╢Ьыае: GraphML(`tsumugi build-graphml`), ьШдэФДыЭ╝ьЭ╕ ьЫ╣ьХ▒ ы▓ИыУд(`tsumugi build-webapp`)

## ьВмьЪй ъ░АыКеэХЬ ыкЕыа╣
- `tsumugi run`: IMPC ыН░ьЭ┤эД░ыбЬ ыДдэК╕ьЫМэБм ьЮмъ│ДьВ░  
- `tsumugi mp --include/--exclude (--pairwise/--genewise)`: MP ьЪйьЦ┤ ъ╕░ьдАьЬ╝ыбЬ эОШьЦ┤ ыШРыКФ ьЬаьаДьЮР ыЛиьЬД эХДэД░  
- `tsumugi count --pairwise/--genewise (--min/--max)`: эСЬэШДэШХ ьИШыбЬ эХДэД░(эОШьЦ┤/ьЬаьаДьЮР)  
- `tsumugi score (--min/--max)`: ьЬаьВмыПД ьаРьИШыбЬ эХДэД░(эОШьЦ┤)
- `tsumugi genes --keep/--drop`: ьЬаьаДьЮР ыжмьКдэК╕ыбЬ ьЬаьзА/ьВньаЬ  
- `tsumugi life-stage --keep/--drop`: ыЭ╝ьЭ┤эФД ьКдэЕМьЭ┤ьзА эХДэД░  
- `tsumugi sex --keep/--drop`: ьД▒ы│Д эХДэД░  
- `tsumugi zygosity --keep/--drop`: ьаСэХйэШХ эХДэД░  
- `tsumugi build-graphml`: GraphML ьГЭьД▒  
- `tsumugi build-webapp`: TSUMUGI ьЫ╣ьХ▒ ьЮРьВ░ ьГЭьД▒

## ьДдь╣Ш
BioConda:
```bash
conda install -c conda-forge -c bioconda tsumugi
```
PyPI:
```bash
pip install tsumugi
```
`tsumugi --version`ьЭ┤ ы│┤ьЭ┤ый┤ ьдАы╣Д ьЩДыгМьЮЕыЛИыЛдуАВ

## ьг╝ьЪФ ьВмьЪй ьШИ(ыкЕыа╣ы│Д)

### IMPC ыН░ьЭ┤эД░ыбЬ ьЮмъ│ДьВ░(`tsumugi run`)
`--mp_obo`ые╝ ьГЭыЮ╡эХШый┤ ыПЩы┤ЙыРЬ `data-version: releases/2025-08-27/mp.obo`ые╝ ьВмьЪйэХйыЛИыЛдуАВ  
`--impc_phenodigm`ьЭД ьГЭыЮ╡эХШый┤ 2025-10-01ьЧР IMPC Disease Models PortalьЧРьДЬ ы░ЫьЭА эММьЭ╝ьЭД ьВмьЪйэХйыЛИыЛдуАВ
```bash
tsumugi run \
  --statistical_results ./statistical-results-ALL.csv.gz \
  --threads 8
```
ь╢Ьыае: `./tsumugi-output`ьЧР genewise/pairwise JSONLъ│╝ `TSUMUGI-webapp`ьЭ┤ ьГЭьД▒ыРйыЛИыЛдуАВ

> [!IMPORTANT]  
> `TSUMUGI-webapp`ьЧРыКФ OSы│Д ьЛдэЦЙ ьКдэБмыж╜эК╕ъ░А эПмэХиыРШьЦ┤ ьЮИьК╡ыЛИыЛдуАВыНФы╕ФэБ┤ыжньЬ╝ыбЬ ыбЬь╗м ьЫ╣ьХ▒ьЭД ьЧ┤ ьИШ ьЮИьК╡ыЛИыЛдуАВ  
> - Windows: `open_webapp_windows.bat`  
> - macOS: `open_webapp_mac.command`  
> - Linux: `open_webapp_linux.sh`

### MP ьЪйьЦ┤ эХДэД░(`tsumugi mp --include/--exclude`)
ъ┤АьЛм ьЮИыКФ эСЬэШДэШХьЭД ъ░АьзД ьЬаьаДьЮР эОШьЦ┤ызМ ь╢Фь╢ЬэХШъ▒░ыВШ, эХ┤ыЛ╣ эСЬэШДэШХьЭД ь╕бьаХэЦИьзАызМ ьЬаьЭШэХЬ ьЭ┤ьГБьЭ┤ ьЧЖьЧИыНШ ьЬаьаДьЮР эОШьЦ┤ые╝ ь╢Фь╢ЬэХа ьИШ ьЮИьК╡ыЛИыЛдуАВ

- `--pairwise`(ъ╕░ы│╕ъ░Т): ьЬаьаДьЮР эОШьЦ┤ ыЛиьЬД ь╢Ьыае. `--in pairwise_similarity_annotations.jsonl(.gz)`ые╝ ьаДыЛмэХйыЛИыЛд.
- `--genewise`: ьЬаьаДьЮР ыЛиьЬД ь╢Ьыае. `--genewise_annotations genewise_phenotype_annotations.jsonl(.gz)`ые╝ ьВмьЪйэХйыЛИыЛд(`--exclude` эХДьИШ, `--include` ъ╢МьЮе).

```bash
# MP:0001146(abnormal testis morphology)ьЩА ъ╖╕ эХШьЬД эСЬэШДэШХ(MP:0004849 (abnormal testis size) ыУ▒)ьЭД эПмэХиэХШыКФ ьЬаьаДьЮР эОШьЦ┤ызМ ь╢Фь╢Ь
tsumugi mp --include MP:0001146 \
  --in pairwise_similarity_annotations.jsonl.gz \
  > pairwise_filtered.jsonl

# MP:0001146(abnormal testis morphology)ьЩА ъ╖╕ эХШьЬД эСЬэШДэШХ(MP:0004849 (abnormal testis size) ыУ▒)ьЭД ь╕бьаХэЦИьзАызМ ьЬаьЭШэХЬ ьЭ┤ьГБьЭ┤ ьЧЖьЧИыНШ ьЬаьаДьЮР эОШьЦ┤ые╝ ь╢Фь╢Ь
tsumugi mp --exclude MP:0001146 \
  --genewise genewise_phenotype_annotations.jsonl.gz \
  --in pairwise_similarity_annotations.jsonl.gz \
  > pairwise_filtered.jsonl

# MP:0001146(эХШьЬД эПмэХи)ьЭД ъ░ЦыКФ ьЬаьЭШэХЬ ьЬаьаДьЮР ыЛиьЬД ьг╝ьДЭызМ ь╢Фь╢Ь
tsumugi mp --include MP:0001146 \
  --genewise \
  --genewise_annotations genewise_phenotype_annotations.jsonl.gz \
  > genewise_filtered.jsonl

# MP:0001146(эХШьЬД эПмэХи)ьЭД ь╕бьаХэЦИьЬ╝ыВШ ьЬаьЭШэХШьзА ьХКьХШыНШ ьЬаьаДьЮР ь╢Фь╢Ь
tsumugi mp --exclude MP:0001146 \
  --genewise \
  --genewise_annotations genewise_phenotype_annotations.jsonl.gz \
  > genewise_no_phenotype.jsonl
```

> [!IMPORTANT]
> **ьзАьаХэХЬ MP ьЪйьЦ┤ьЭШ эХШьЬД ьЪйьЦ┤ыПД эХиъ╗Ш ь▓ШыжмыРйыЛИыЛд.**  
> ьШИые╝ ыУдьЦ┤ `MP:0001146 (abnormal testis morphology)`ые╝ ьзАьаХэХШый┤ `MP:0004849 (abnormal testis size)` ыУ▒ьЭШ эХШьЬД ьЪйьЦ┤ыПД ъ│аыадыРйыЛИыЛдуАВ

### эСЬэШДэШХ ьИШ эХДэД░(`tsumugi count`)
At least one of `--min` or `--max` is required. Use either alone for one-sided filtering.
- эОШьЦ┤ыЛ╣ ъ│╡ьЬа эСЬэШДэШХ:
```bash
tsumugi count --pairwise --min 3 --max 20 \
  --in pairwise_similarity_annotations.jsonl.gz \
  > pairwise_min3_max20.jsonl
```
- ьЬаьаДьЮРы│Д эСЬэШДэШХ( genewise эХДьЪФ ):
```bash
tsumugi count --genewise --min 5 --max 50 \
  --genewise genewise_phenotype_annotations.jsonl.gz \
  --in pairwise_similarity_annotations.jsonl.gz \
  > genewise_min5_max50.jsonl
```
`--min` ыШРыКФ `--max` ыЛиыПЕ ьВмьЪйыПД ъ░АыКеэХйыЛИыЛдуАВ


### рд╕рдорд╛рдирддрд╛ рд╕реНрдХреЛрд░ рд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░ (`tsumugi score`)
```txt
tsumugi score [-h] [--min MIN] [--max MAX] [--in IN]
```

`phenotype_similarity_score` (0тАУ100) рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЬреАрди рдкреЗрдпрд░ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░реЗрдВред `--min` рдпрд╛ `--max` рдореЗрдВ рд╕реЗ рдХрдо рд╕реЗ рдХрдо рдПрдХ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

#### `--min MIN`, `--max MAX`
рд╕реНрдХреЛрд░ рдХреА рдиреНрдпреВрдирддрдо/рдЕрдзрд┐рдХрддрдо рд╕реАрдорд╛ред рдПрдХ рд╣реА рд╕реАрдорд╛ рджреЗрдХрд░ рднреА рдПрдХрддрд░рдлрд╛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

#### `--in IN`
рдкреЗрдпрд░реНрд╡рд╛рдЗрдЬрд╝ рдПрдиреЛрдЯреЗрд╢рди рдлрд╝рд╛рдЗрд▓ (JSONL/.gz) рдХрд╛ рдкрде; рдирд╣реАрдВ рджреЗрдиреЗ рдкрд░ STDIN рд╕реЗ рдкрдврд╝рддрд╛ рд╣реИред

```bash
tsumugi score --min 50 --max 80 \
  --in pairwise_similarity_annotations.jsonl.gz \
  > pairwise_score50_80.jsonl
```

`--min` рдпрд╛ `--max` рдЕрдХреЗрд▓реЗ рднреА рдЪрд▓реЗрдЧрд╛ред

### ьЬаьаДьЮР ыжмьКдэК╕ эХДэД░(`tsumugi genes --keep/--drop`)
```bash
tsumugi genes --keep genes.txt \
  --in pairwise_similarity_annotations.jsonl.gz \
  > pairwise_keep_genes.jsonl

tsumugi genes --drop geneA,geneB \
  --in pairwise_similarity_annotations.jsonl.gz \
  > pairwise_drop_genes.jsonl
```

### ыЭ╝ьЭ┤эФД ьКдэЕМьЭ┤ьзА / ьД▒ы│Д / ьаСэХйэШХ
```bash
tsumugi life-stage --keep Early --in pairwise_similarity_annotations.jsonl.gz > pairwise_lifestage_early.jsonl
tsumugi sex --drop Male --in pairwise_similarity_annotations.jsonl.gz > pairwise_no_male.jsonl
tsumugi zygosity --keep Homo --in pairwise_similarity_annotations.jsonl.gz > pairwise_homo.jsonl
```

### GraphML / ьЫ╣ьХ▒ ьГЭьД▒
```bash
tsumugi build-graphml \
  --in pairwise_similarity_annotations.jsonl.gz \
  --genewise genewise_phenotype_annotations.jsonl.gz \
  > network.graphml

tsumugi build-webapp \
  --in pairwise_similarity_annotations.jsonl.gz \
  --genewise genewise_phenotype_annotations.jsonl.gz \
```

эММьЭ┤эФД ьШИ: `zcat ... | tsumugi mp ... | tsumugi genes ... > out.jsonl`

# ЁЯФН ыПЩьЭ╝ эСЬэШДэШХ ьЬаьаДьЮРъ╡░ ъ│ДьВ░

## ыН░ьЭ┤эД░ ьЖМьКд
[IMPC Release-23.0](https://ftp.ebi.ac.uk/pub/databases/impc/all-data-releases/release-23.0/results) `statistical-results-ALL.csv.gz`  
эХДыУЬ: [Data fields](https://www.mousephenotype.org/help/programmatic-data-access/data-fields/)

## ьаДь▓Шыжм
P тЙд 0.0001(`p_value`, `female_ko_effect_p_value`, `male_ko_effect_p_value`)ьЭ╕ ьЬаьаДьЮРтАУэСЬэШДэШХ ь╢Фь╢Ь  
- Zygosity: `homo`, `hetero`, `hemi`  
- Sex: `female`, `male`

## эСЬэШДэШХ ьЬаьВмыПД
TSUMUGIыКФ эШДьЮм Phenodigmъ│╝ ьЬаьВмэХЬ ьаСъ╖╝ьЭД ьВмьЪйэХйыЛИыЛд. MPьЪйьЦ┤ ъ░Д **Resnik ьЬаьВмыПД**ьЩА ьб░ьГБ ьзСэХйьЭШ **Jaccard ьЬаьВмыПД**ые╝ ъ│ДьВ░эХЬ ыТд **ъ╕░эХШэПЙъ╖а**ьЬ╝ыбЬ ъ▓░эХйэХйыЛИыЛд. ьЫРыЮШ Phenodigmъ│╝ьЭШ эХ╡ьЛм ь░иьЭ┤ыКФ ыйФэГАыН░ьЭ┤эД░(zygosity, life stage, sexual dimorphism) ьЭ╝ь╣ШыПДьЧР ыФ░ые╕ ъ░АьдСь╣Шые╝ ьаБьЪйэХЬыЛдыКФ ьаРьЮЕыЛИыЛд.

1. MP ьШиэЖиыбЬьзАые╝ ъ╡мь╢ХэХШъ│а ICые╝ ъ│ДьВ░эХйыЛИыЛд:  
   `IC(term) = -log((|Descendants(term)| + 1) / |All MP terms|)`  
   IC эХШьЬД 5эН╝ьД╝эГАьЭ╝ ьЪйьЦ┤ыКФ 0ьЬ╝ыбЬ ьДдьаХэХйыЛИыЛд.
2. ъ░Б MP ьЪйьЦ┤ ьМНьЧРьДЬ ъ░АьЮе эК╣ьЭ┤эХЬ ъ│╡эЖ╡ ьб░ьГБ(MICA)ьЭД ь░╛ъ│а ъ╖╕ ICые╝ ResnikьЬ╝ыбЬ ьВмьЪйэХйыЛИыЛд.  
   ьб░ьГБ ьзСэХйьЭШ Jaccard ьзАьИШые╝ ъ│ДьВ░эХйыЛИыЛд.  
   ьЪйьЦ┤ ьМН ьЬаьВмыПД = `sqrt(Resnik * Jaccard)`.
3. ъ░Б ьЬаьаДьЮР ьМНьЧР ыМАэХ┤ ьЪйьЦ┤├ЧьЪйьЦ┤ ьЬаьВмыПД эЦЙыамьЭД ызМыУдъ│а ыйФэГАыН░ьЭ┤эД░ ъ░АьдСь╣Шые╝ ьаБьЪйэХйыЛИыЛд.  
   zygosity/ыЭ╝ьЭ┤эФДьКдэЕМьЭ┤ьзА/ьД▒ьаБ ьЭ┤эШХ ьЭ╝ь╣Ш ьИШ(0/1/2/3)ьЧР ыМАэХ┤ 0.25/0.5/0.75/1.0ьЭД ы╢АьЧмэХйыЛИыЛд.
4. Phenodigm ы░йьЛЭьЬ╝ыбЬ 0тАУ100 ьаХъ╖ЬэЩФые╝ ьаБьЪйэХйыЛИыЛд:  
   эЦЙ/ьЧ┤ ь╡ЬыМАъ░ТьЧРьДЬ ьЛдьаЬ max/meanьЭД ъ╡мэХШъ│а IC ъ╕░ы░Ш ьЭ┤ыба max/meanьЬ╝ыбЬ ьаХъ╖ЬэЩФэХйыЛИыЛд.  
   `Score = 100 * (normalized_max + normalized_mean) / 2`  
   ьЭ┤ыба ы╢Дыкиъ░А 0ьЭ┤ый┤ 0ьЬ╝ыбЬ ыСбыЛИыЛд.

# тЬЙя╕П ьЧ░ыЭ╜
- Google Form: https://forms.gle/ME8EJZZHaRNgKZ979  
- GitHub Issues: https://github.com/akikuno/TSUMUGI-dev/issues/new/choose
